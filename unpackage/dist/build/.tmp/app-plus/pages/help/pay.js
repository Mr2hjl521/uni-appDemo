(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/help/pay"],{"04f8e":function(e,t,o){"use strict";o.r(t);var s=o("d7a5"),n=o("21c4");for(var i in n)"default"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);o("0b6b");var c,a=o("f0c5"),r=Object(a["a"])(n["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],c);t["default"]=r.exports},"0b6b":function(e,t,o){"use strict";var s=o("8644"),n=o.n(s);n.a},"21c4":function(e,t,o){"use strict";o.r(t);var s=o("cbad"),n=o.n(s);for(var i in s)"default"!==i&&function(e){o.d(t,e,function(){return s[e]})}(i);t["default"]=n.a},8644:function(e,t,o){},cbad:function(e,t,o){"use strict";(function(e,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s={data:function(){return{myShow:0,myPrice:"",userId:"",clientUserCouponsIds:[],assets:"",cuIsPrompt:"",priceArr:[],orderId:"",outTradeNo:"",cuIsRecharge:"",tipsWindow:"",coupclientUserCouponsListon:0,count:"",info:{},code:"",packageInfo:[],coupon:!1,payWindows:!1,remindWindows:!1,items:[],reminds:[{value:"1",name:"我知道了"},{value:"2",name:"不再弹出"}],payitems:[{value:"0",methods:"微信支付"},{value:"1",methods:"余额支付"}],current:"",type:9}},onLoad:function(e){var t=Number(e.orderId);this.orderId=t},onReady:function(){},onPageScroll:function(e){},onReachBottom:function(){},mounted:function(){},onShow:function(){var t=this;this.Get("http://39.99.137.77:8081/projects/takeDeliveryOrder/findById?id="+this.orderId,{},function(o){console.log(e(o," at pages\\help\\pay.vue:193")),t.info=o,t.assets=o.assets,t.myPrice=o.price,t.packageInfo=o.parcelBoList[0].list;for(var s=0;s<t.packageInfo.length;s++)""==t.packageInfo[s].name?t.packageInfo[s]["key"]=!1:t.packageInfo[s]["key"]=!0;console.log(e(t.packageInfo," at pages\\help\\pay.vue:205")),console.log(e(o.parcelBoList[0].list," at pages\\help\\pay.vue:206"));for(var n=o.parcelBoList[0].list,i=0;i<n.length;i++)0==n[i].status&&t.priceArr.push(n[i]);var c=Number(t.priceArr.length);if(t.count=1*c,o.clientUserCouponsList.length<=0)t.coupclientUserCouponsListon=0;else{var a=o.clientUserCouponsList;for(s=0;s<a.length;s++)2==a[s].coId&&(t.items.push({value:a[s].cucId.toString(),name:a[s].coFullReduction}),t.coupclientUserCouponsListon=1)}t.tipsWindow=o.cuIsPrompt,0==o.cuIsPrompt&&(t.myShow=0),1==o.cuIsPrompt&&(t.myShow=1),t.outTradeNo=o.outTradeNo,t.cuIsRecharge=o.cuIsRecharge,t.callbackone()})},onBackPress:function(t){o.showModal({title:"提示",content:"当前订单还未支付,是否确定退出？",success:function(t){t.confirm?(console.log(e("用户点击确定"," at pages\\help\\pay.vue:262")),o.reLaunch({url:"/pages/tabBar/home/home"})):t.cancel&&console.log(e("用户点击取消"," at pages\\help\\pay.vue:267"))}})},methods:{callbackone:function(){this.myPrice;var t=this.outTradeNo,s=this.orderId,n=this.clientUserCouponsIds;console.log(e(t," at pages\\help\\pay.vue:281")),o.request({method:"POST",url:"http://39.99.137.77:8081/projects/appPay/notifyUrl",data:{outTradeNo:t,type:1,clientUserCouponsId:n},header:{"Content-Type":"application/json"},success:function(t){console.log(e(t.data," at pages\\help\\pay.vue:294")),200==t.data.code&&o.navigateTo({url:"../pay/success/success?num=1&orderId="+s})},fail:function(e){}})},chosecoupon:function(){this.coupon=!0},closeWindows:function(){this.coupon=!1},closeWindowsAndGo:function(){var e=this;if(2==this.code&&o.showModal({title:"提示",content:"请您勾选我知道了,关闭此提示框",success:function(e){e.confirm||e.cancel}}),1==this.code&&(this.remindWindows=!1,this.myShow=1,0==this.myPrice&&(this.remindWindows=!1,this.Post("http://39.99.137.77:8081/projects/couponsPay/takePay",{clientUserCouponsIds:this.clientUserCouponsIds,orderNumber:this.outTradeNo,price:this.myPrice},function(t){200==t.code?o.navigateTo({url:"../pay/success/success?num=1&orderId="+e.orderId}):o.showToast({title:"支付失败",icon:"none"})})),this.myPrice>0&&(this.payWindows=!0)),3==this.code){this.remindWindows=!1;var t=this;o.getStorage({key:"userId",success:function(e){t.Put("http://39.99.137.77:8081/projects/clientUser",{id:e.data,isPrompt:1},function(e){})}}),0==this.myPrice&&this.Post("http://39.99.137.77:8081/projects/couponsPay/takePay",{clientUserCouponsIds:this.clientUserCouponsIds,orderNumber:this.outTradeNo,price:this.myPrice},function(t){200==t.code?o.navigateTo({url:"../pay/success/success?num=1&orderId="+e.orderId}):o.showToast({title:"支付失败",icon:"none"})}),this.myPrice>0&&(this.payWindows=!0)}},checkboxChange:function(e){for(var t=this.items,o=e.detail.value,s=0,n=t.length;s<n;++s){var i=t[s];o.includes(i.value)?this.$set(i,"checked",!0):this.$set(i,"checked",!1)}this.clientUserCouponsIds=o;var c=Number(this.clientUserCouponsIds.length),a=this.info.price;this.myPrice=a-c},checkboxChange2:function(e){for(var t=this.items,o=e.detail.value,s=0,n=t.length;s<n;++s){var i=t[s];o.includes(i.value)?this.$set(i,"checked",!0):this.$set(i,"checked",!1)}for(var c=o,a=0;a<c.length;a++)"1"===c[a]&&(this.code=1),"2"===c[a]&&(this.code=2);var r=o.length;0==r&&(this.code=0),2==r&&(this.code=3)},closePayMethod:function(){var e=this;0==this.myShow?this.remindWindows=!0:1==this.myShow&&(this.remindWindows=!1,0==this.myPrice&&this.Post("http://39.99.137.77:8081/projects/couponsPay/takePay",{clientUserCouponsIds:this.clientUserCouponsIds,orderNumber:this.outTradeNo,price:this.myPrice},function(t){200==t.code&&o.navigateTo({url:"../pay/success/success?num=1&orderId="+e.orderId})}),this.myPrice>0&&(this.payWindows=!0),this.myPrice<0&&o.showModal({title:"提示",content:"当前金额小于0元,无法支付。",success:function(e){e.confirm||e.cancel}}))},closePayWindows:function(){this.payWindows=!1},pay:function(){if(0==this.type){var t=this.myPrice,s=this.outTradeNo,n=this.orderId,i=this.clientUserCouponsIds;i.length;this.Get("http://39.99.137.77:8081/projects/appPay/pay?price="+t+"&outTradeNo="+s,{},function(t){if(console.log(e(t," at pages\\help\\pay.vue:575")),200==t.code){var c=t.data;console.log(e(c," at pages\\help\\pay.vue:579")),o.requestPayment({provider:"wxpay",orderInfo:{appid:c.appid,noncestr:c.noncestr,package:"Sign=WXPay",partnerid:c.partnerid,prepayid:c.prepayid,timestamp:c.timestamp,sign:c.sign},success:function(t){console.log(e("成功哦哦"," at pages\\help\\pay.vue:592"))},fail:function(t){console.log(e("失败"," at pages\\help\\pay.vue:595"))},complete:function(t){console.log(e("完成"," at pages\\help\\pay.vue:598")),console.log(e(t," at pages\\help\\pay.vue:599")),o.request({method:"POST",url:"http://39.99.137.77:8081/projects/appPay/notifyUrl",data:{outTradeNo:s,type:1,clientUserCouponsId:i},header:{"Content-Type":"application/json"},success:function(e){200==e.data.code?o.navigateTo({url:"../pay/success/success?num=1&orderId="+n}):(o.showModal({content:"支付异常",showCancel:!1}),o.navigateTo({url:"/pages/help/pay?orderId="+n}))},fail:function(e){}})}})}400==t.code&&o.showModal({title:"提示",content:"由于您第一次支付取消，这次支付必须使用与上次数量相同的优惠券",success:function(e){e.confirm||e.cancel}})})}if(1==this.type){if(this.myPrice>this.assets&&o.showModal({title:"提示",content:"余额不足，是否去充值？",success:function(e){e.confirm?o.navigateTo({url:"../recharge/recharge"}):e.cancel}}),this.myPrice<=this.assets){var c=this.orderId;this.Post("http://39.99.137.77:8081/projects/couponsPay/takePay",{clientUserCouponsIds:this.clientUserCouponsIds,orderNumber:this.outTradeNo,price:this.myPrice},function(e){200==e.code?setTimeout(function(){o.hideLoading(),o.navigateTo({url:"../pay/success/success?num=1&orderId="+c})},1e3):(o.showToast({title:"支付失败",duration:1e3}),setTimeout(function(){o.hideLoading(),o.switchTab({url:"../tabBar/home/home"})},2e3))})}this.payWindows=!1}9==this.type&&o.showModal({title:"提示",content:"亲爱的用户,您忘记选择支付方式了哦",success:function(e){e.confirm||e.cancel}})},radioChange:function(e){for(var t=0;t<this.items.length;t++)if(this.items[t].value===e.target.value){this.current=t;break}this.type=e.target.value},toRecharge:function(){o.navigateTo({url:"../recharge/recharge"})},Post:function(e,t,s){o.request({method:"POST",url:e,data:t,header:{"Content-Type":"application/json"},success:function(e){s(e.data)},fail:function(e){alert(e.data)}})},Get:function(e,t,s){o.request({url:e,data:t,header:{"Content-Type":"application/json"},success:function(e){s(e.data)},fail:function(e){s(e)}})},Put:function(e,t,s){o.request({method:"PUT",url:e,data:t,header:{"Content-Type":"application/json"},success:function(e){s(e.data)},fail:function(e){alert("信息错误")}})}}};t.default=s}).call(this,o("0de9")["default"],o("6e42")["default"])},d7a5:function(e,t,o){"use strict";var s,n=function(){var e=this,t=e.$createElement,s=(e._self._c,o("dd79"));e.$mp.data=Object.assign({},{$root:{m0:s}})},i=[];o.d(t,"b",function(){return n}),o.d(t,"c",function(){return i}),o.d(t,"a",function(){return s})},de8c:function(e,t,o){"use strict";(function(e){o("5925"),o("921b");s(o("66fd"));var t=s(o("04f8e"));function s(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("6e42")["createPage"])}},[["de8c","common/runtime","common/vendor"]]]);